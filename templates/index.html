{% extends 'base.html' %}

{% block content %}

{% if not current_user.is_authenticated %}
<div class="p-5 mb-4 bg-light rounded-3 text-center">
    <div class="container-fluid py-5">
      <h1 class="display-5 fw-bold">–°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–∏–Ω–æ—Å—ä–µ–º–∫–∞–º–∏</h1>
      <p class="fs-4">–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —É—á–µ—Ç–∞ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è –≤ "–§–µ–Ω–∏–∫—Å –°–∏–Ω–µ–º–∞".</p>
      <a href="/login" class="btn btn-primary btn-lg">–í–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É</a>
    </div>
</div>

{% else %}
<div class="mb-4">
    <h3>üëã –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, {{ current_user.username }}!</h3>
    <p class="text-muted">–°–≤–æ–¥–∫–∞ –ø–æ —Å—Ç—É–¥–∏–∏ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è: <strong>{{ today_date.strftime('%d.%m.%Y') }}</strong></p>
</div>

<div class="row mb-4">
    <div class="col-md-4">
        <div class="card text-white bg-primary mb-3 shadow-sm">
            <div class="card-header">–ê–∫—Ç–∏–≤–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã</div>
            <div class="card-body">
                <h2 class="card-title">{{ total_projects }}</h2>
                <p class="card-text">–í—Å–µ–≥–æ —Å—ä—ë–º–æ—á–Ω—ã—Ö –≥—Ä—É–ø–ø</p>
            </div>
        </div>
    </div>
    
    <div class="col-md-4">
        <div class="card text-white bg-warning mb-3 shadow-sm">
            <div class="card-header">–ó–∞–Ω—è—Ç–æ —Å–µ–≥–æ–¥–Ω—è</div>
            <div class="card-body">
                <h2 class="card-title">{{ busy_count }}</h2>
                <p class="card-text">–ï–¥–∏–Ω–∏—Ü —Ç–µ—Ö–Ω–∏–∫–∏ –Ω–∞ —Ä—É–∫–∞—Ö</p>
            </div>
        </div>
    </div>

    <div class="col-md-4">
        <div class="card text-white bg-success mb-3 shadow-sm">
            <div class="card-header">–ü–∞—Ä–∫ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è</div>
            <div class="card-body">
                <h2 class="card-title">{{ total_equipment }}</h2>
                <p class="card-text">–í—Å–µ–≥–æ –µ–¥–∏–Ω–∏—Ü –Ω–∞ —Å–∫–ª–∞–¥–µ</p>
            </div>
        </div>
    </div>
</div>

<div class="card shadow">
    <div class="card-header bg-dark text-white d-flex justify-content-between align-items-center">
        <h5 class="mb-0">üìÖ –ì—Ä–∞—Ñ–∏–∫ —Å—ä–µ–º–æ–∫ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è</h5>
        <a href="/projects" class="btn btn-sm btn-light">–í—Å–µ –ø—Ä–æ–µ–∫—Ç—ã</a>
    </div>
    <div class="card-body">
        {% if bookings_today %}
            <table class="table table-hover align-middle">
                <thead class="table-light">
                    <tr>
                        <th>–ü—Ä–æ–µ–∫—Ç</th>
                        <th>–û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ</th>
                        <th>–¢–∏–ø</th>
                        <th>–°—Ç–∞—Ç—É—Å</th>
                    </tr>
                </thead>
                <tbody>
                    {% for booking in bookings_today %}
                    <tr>
                        <td class="fw-bold">{{ booking.project.title }}</td>
                        <td>{{ booking.equipment.name }}</td>
                        <td>
                            {% if booking.equipment.type == 'camera' %} <span class="badge bg-primary">–ö–∞–º–µ—Ä–∞</span>
                            {% elif booking.equipment.type == 'light' %} <span class="badge bg-warning text-dark">–°–≤–µ—Ç</span>
                            {% else %} <span class="badge bg-secondary">–†–µ–∫–≤–∏–∑–∏—Ç</span>
                            {% endif %}
                        </td>
                        <td><span class="badge bg-danger">–í—ã–¥–∞–Ω–æ</span></td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        {% else %}
            <div class="text-center py-4 text-muted">
                <h4>üéâ –ù–∞ —Å–µ–≥–æ–¥–Ω—è —Å—ä–µ–º–æ–∫ –Ω–µ—Ç</h4>
                <p>–í—Å–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ —Å–≤–æ–±–æ–¥–Ω–æ –∏ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –Ω–∞ —Å–∫–ª–∞–¥–µ.</p>
            </div>
        {% endif %}
    </div>
</div>
{% endif %}

{% endblock %}